# Feature Specification: 磁检测仪器Web界面系统

**Feature Branch**: `001-web`  
**Created**: 2025-10-07  
**Status**: Draft  
**Input**: 用户需求 - 开发接触式磁检测仪器软件网页版，完全复现DOPPLER工业级仪器界面，实现符合ISO 9934-1:2016国际标准的磁检测功能

---

## 项目概述

本系统旨在为无损检测（NDT）工程师和质量控制人员提供一个现代化、高端的Web端磁检测仪器控制平台。系统将复现专业硬件设备的工业化界面设计，并提供符合国际标准的磁粉检测和磁漏检测完整工作流程。

**业务价值**：
- 让检测人员可以通过Web浏览器访问专业磁检测功能，无需专用硬件
- 实现检测数据的云端存储和协同分析
- 符合ISO 9934-1:2016等国际标准，确保检测结果的可靠性和合规性
- 提供直观的工业化界面，降低操作人员培训成本

---

## User Scenarios & Testing *(mandatory)*

### User Story 1 - 实时磁信号监测与波形显示 (Priority: P1)

**用户故事**：作为一名无损检测工程师，我需要实时监控磁信号波形，以便在检测过程中即时发现工件缺陷位置和特征。

**为什么这是P1优先级**：这是磁检测的核心功能，没有实时信号监测就无法进行有效的缺陷检测。这是整个系统的基础，必须最先实现。

**独立测试标准**：
- 能够显示实时更新的磁信号波形图
- 双通道信号同时显示（横向和纵向磁化）
- 信号幅值达到预设阈值时自动标记潜在缺陷
- 波形图可缩放、平移、标注
- 完全独立可用，无需其他功能模块

**验收场景**：

1. **Given** 系统已启动且传感器连接正常，**When** 开始扫描检测，**Then** 主显示区域实时显示磁信号波形，刷新率不低于每秒30次
2. **Given** 正在进行扫描，**When** 信号幅值超过设定阈值（如80mV），**Then** 系统在波形图上自动标记该点，并在数据表格中记录位置坐标
3. **Given** 波形图已显示历史数据，**When** 用户使用鼠标滚轮或触控手势，**Then** 波形图可以平滑缩放，显示更多或更少的时间范围
4. **Given** 检测到疑似缺陷信号，**When** 用户点击波形上的标记点，**Then** 显示该位置的详细信号参数（幅值、频率、相位、时间戳）

---

### User Story 2 - 实验项目创建与数据记录 (Priority: P1)

**用户故事**：作为质量控制主管，我需要创建标准化的检测实验项目并完整记录所有检测参数，以确保检测过程符合ISO 9934-1:2016标准要求，并可追溯审计。

**为什么这是P1优先级**：标准化的实验记录是质量管理体系的基本要求，也是生成合规检测报告的前提。这与P1的信号监测功能同等重要。

**独立测试标准**：
- 能够创建包含所有必需字段的实验项目
- 所有字段符合ISO 9934-1:2016标准要求
- 实验数据自动保存到云端
- 可以查询和加载历史实验记录
- 不依赖实时信号监测，可独立使用

**验收场景**：

1. **Given** 用户点击"新建实验"按钮，**When** 填写项目名称、工件信息、检测标准、操作人员资质等必填字段，**Then** 系统创建实验项目并分配唯一编号，所有信息保存到云端数据库
2. **Given** 实验项目已创建，**When** 用户设置磁化参数（磁化方式、电流、频率）和检测参数（磁粉类型、灵敏度等级），**Then** 系统记录所有参数并与实验项目关联
3. **Given** 用户在参数配置界面输入无效值（如电流超过设备范围），**When** 尝试保存，**Then** 系统显示明确的错误提示并拒绝保存
4. **Given** 存在多个历史实验，**When** 用户按日期、项目名称或工件名称搜索，**Then** 系统快速返回符合条件的实验列表，响应时间不超过2秒
5. **Given** 用户选择一个历史实验，**When** 点击"加载"，**Then** 系统恢复该实验的所有参数和配置，并显示关联的历史波形数据

---

### User Story 3 - 工业化控制界面操作 (Priority: P1)

**用户故事**：作为仪器操作员，我需要一个直观的、类似硬件设备的控制界面，让我能够快速掌握操作方法，就像使用传统硬件设备一样自然。

**为什么这是P1优先级**：用户界面是用户与系统交互的唯一入口，工业化的界面设计直接影响用户接受度和操作效率。这是用户体验的基础。

**独立测试标准**：
- 界面完全复现DOPPLER硬件设备的外观和布局
- 所有按钮位置和功能与参考图片一致
- 支持鼠标点击和键盘快捷键操作
- 按钮点击有明确的视觉和听觉反馈
- 界面在不同分辨率下正确显示

**验收场景**：

1. **Given** 用户首次访问系统，**When** 查看主界面，**Then** 看到橙色外壳边框、黑色机身背景、左侧6个功能按钮、右侧3个控制按钮、中央大屏幕显示区域，整体呈现工业设备外观
2. **Given** 用户点击左侧任一功能按钮（播放、上传、DISP、接地、GATE、VPA），**When** 鼠标悬停，**Then** 按钮高亮显示，点击后有下压效果并播放点击音效
3. **Given** 系统显示主屏幕，**When** 用户点击右侧MENU按钮，**Then** 弹出系统菜单，包含文件管理、参数配置、系统设置等选项
4. **Given** 用户正在操作，**When** 按下键盘快捷键（如F1-F6对应左侧按钮，Ctrl+S对应SAVE），**Then** 触发相应功能，与鼠标点击效果一致
5. **Given** 屏幕分辨率改变（如从1920x1080变为2560x1440），**When** 刷新页面，**Then** 界面元素等比例缩放，保持工业设备外观比例

---

### User Story 4 - 缺陷记录与分析 (Priority: P2)

**用户故事**：作为检测工程师，我需要在发现缺陷时快速记录缺陷信息（类型、位置、严重程度），并对缺陷进行分类统计分析。

**为什么这是P2优先级**：缺陷记录是在基础信号监测（P1）之上的增值功能，能够提升检测效率和数据价值，但系统在没有此功能时仍可进行基本的信号监测。

**独立测试标准**：
- 可以手动或自动创建缺陷记录
- 缺陷记录包含完整的属性（类型、位置、尺寸、严重程度等）
- 提供缺陷统计图表（数量、分布、类型占比）
- 可以查询和过滤缺陷记录

**验收场景**：

1. **Given** 用户在波形图上发现异常信号，**When** 点击该位置并选择"标记为缺陷"，**Then** 系统打开缺陷记录表单，自动填入位置坐标和信号参数，用户补充缺陷类型（裂纹/气孔/夹杂等）和严重程度（1-5级）
2. **Given** 实验检测完成，**When** 用户查看缺陷统计，**Then** 显示缺陷总数、各类型缺陷数量、缺陷密度（个/米）、合格率等关键指标
3. **Given** 存在多条缺陷记录，**When** 用户选择按严重程度过滤（如只显示4-5级严重缺陷），**Then** 列表只显示符合条件的缺陷，并在波形图上高亮显示这些位置
4. **Given** 用户需要重点关注某个缺陷，**When** 双击缺陷记录，**Then** 显示缺陷详情弹窗，包含位置、尺寸、波形截图、判定依据等完整信息

---

### User Story 5 - 参数配置与预设管理 (Priority: P2)

**用户故事**：作为资深检测工程师，我需要根据不同工件材料和检测要求调整检测参数（磁化电流、增益、门控、滤波器等），并保存常用配置以便快速复用。

**为什么这是P2优先级**：参数配置可以优化检测效果，但使用默认参数也能进行基本检测。此功能面向专业用户，提升检测精度和效率。

**独立测试标准**：
- 提供全面的参数配置界面
- 参数范围和步进符合实际设备规格
- 可以保存和加载配置预设
- 配置变更即时生效

**验收场景**：

1. **Given** 用户点击MENU → 参数配置，**When** 进入配置界面，**Then** 显示磁化参数、增益参数、门控参数、滤波参数四大类别，每类包含若干可调节项，当前值醒目显示
2. **Given** 用户调整磁化电流（如从500mA增加到1000mA），**When** 点击"应用"，**Then** 系统立即使用新参数，波形图显示变化，并记录参数变更到实验日志
3. **Given** 用户配置了一套适合Q345钢板检测的参数，**When** 点击"保存为预设"并命名为"Q345标准配置"，**Then** 系统将配置保存，下次可从预设列表快速加载
4. **Given** 存在多个配置预设，**When** 用户选择"Q345标准配置"并点击"加载"，**Then** 系统恢复该配置的所有参数值，并显示确认消息
5. **Given** 用户输入超出有效范围的参数（如电流设为3000mA，设备上限为2000mA），**When** 失焦或点击保存，**Then** 系统显示红色边框和错误提示"电流值应在0-2000mA之间"

---

### User Story 6 - 文件管理与数据组织 (Priority: P2)

**用户故事**：作为项目经理，我需要按照项目、日期、工件等维度组织管理检测文件，便于归档和检索。

**为什么这是P2优先级**：良好的文件管理能提升工作效率，但不影响核心检测功能。此功能对于处理大量检测任务的用户价值显著。

**独立测试标准**：
- 支持树形目录结构
- 可以创建、重命名、删除文件夹和文件
- 文件按类型分类（实验数据、报告、图像等）
- 支持文件搜索

**验收场景**：

1. **Given** 用户打开文件管理界面，**When** 查看文件树，**Then** 看到根目录下按项目名称组织的文件夹，每个项目文件夹下包含实验数据、报告、图像等子文件夹
2. **Given** 用户需要创建新项目文件夹，**When** 右键点击根目录选择"新建文件夹"并输入名称，**Then** 系统创建文件夹并显示在文件树中
3. **Given** 用户需要查找某个工件的检测记录，**When** 在搜索框输入工件名称，**Then** 系统返回所有包含该工件的实验文件，响应时间不超过1秒
4. **Given** 用户选中一个实验文件，**When** 点击"导出"，**Then** 系统将实验数据、波形图、缺陷记录打包为ZIP文件并下载到本地

---

### User Story 7 - 检测报告生成与导出 (Priority: P3)

**用户故事**：作为质量经理，我需要生成符合ISO 9934-1:2016标准的检测报告（PDF格式），包含完整的检测参数、波形图、缺陷记录和结论，用于客户交付和质量归档。

**为什么这是P3优先级**：报告生成是检测流程的最后环节，前面的功能（P1-P2）都完成后才需要。虽然重要，但可以暂时手动整理数据生成报告。

**独立测试标准**：
- 生成的PDF报告包含所有必需章节
- 报告内容准确无误，格式专业
- 可以自定义报告模板
- 支持批量生成多个实验报告

**验收场景**：

1. **Given** 实验检测完成，**When** 用户点击"生成报告"，**Then** 系统生成PDF报告，包含封面、实验信息、检测参数、波形图、缺陷列表、统计分析、结论和操作人员签名栏
2. **Given** 报告已生成，**When** 用户打开PDF文件，**Then** 所有图表清晰可读，数据与实验记录一致，格式符合ISO 9934-1:2016标准模板
3. **Given** 用户需要修改报告模板（如添加公司Logo），**When** 在系统设置中上传Logo并调整报告模板，**Then** 后续生成的报告使用新模板
4. **Given** 用户选择多个实验项目，**When** 点击"批量生成报告"，**Then** 系统按序生成多个PDF文件并打包下载

---

### User Story 8 - 多用户协作与权限管理 (Priority: P3)

**用户故事**：作为系统管理员，我需要为不同用户分配角色和权限（管理员、操作员、查看者），确保数据安全和操作规范。

**为什么这是P3优先级**：单用户使用时不需要权限管理，但多人团队协作时必不可少。可以在MVP阶段暂时忽略，后续再添加。

**独立测试标准**：
- 支持用户注册、登录、登出
- 三种角色权限清晰区分
- 操作日志完整记录
- 敏感操作需要确认

**验收场景**：

1. **Given** 新用户首次访问，**When** 使用邮箱和密码注册，**Then** 系统创建账户并默认分配"操作员"角色
2. **Given** 管理员登录系统，**When** 进入用户管理页面，**Then** 可以查看所有用户列表，修改用户角色，禁用/启用账户
3. **Given** 查看者角色用户登录，**When** 尝试修改实验数据或删除记录，**Then** 系统拒绝操作并提示"您没有权限执行此操作"
4. **Given** 管理员需要审计操作记录，**When** 查看系统日志，**Then** 显示所有用户的操作历史（登录、创建实验、修改参数、删除数据等），包含时间戳和IP地址

---

### User Story 9 - 数据导出与Excel分析 (Priority: P3)

**用户故事**：作为数据分析师，我需要将原始信号数据和缺陷记录导出为Excel格式，以便进行深度数据分析和统计建模。

**为什么这是P3优先级**：系统内已有基本统计功能（P2），Excel导出是为了满足高级分析需求，适用于特殊场景，非日常必需。

**独立测试标准**：
- 支持导出完整的信号数据（CSV格式）
- 支持导出缺陷记录（Excel格式）
- 导出文件格式正确，可在Excel/Numbers中打开
- 大数据量导出不超时

**验收场景**：

1. **Given** 实验包含10000个信号数据点，**When** 用户选择"导出信号数据"并选择CSV格式，**Then** 系统生成CSV文件，包含时间戳、通道、幅值、频率等列，下载完成时间不超过5秒
2. **Given** 实验包含50条缺陷记录，**When** 用户选择"导出缺陷数据"并选择Excel格式，**Then** 系统生成Excel文件，包含缺陷编号、类型、位置、严重程度等列，支持在Excel中打开和编辑
3. **Given** 用户需要导出多个实验的汇总数据，**When** 选择多个实验并点击"导出汇总"，**Then** 系统生成一个Excel文件，包含多个Sheet页，每个实验一个Sheet

---

### Edge Cases

#### 信号采集相关
- **网络中断时**：系统应将信号数据暂存在本地缓存，网络恢复后自动同步到云端
- **信号异常（超出量程）**：显示警告标识，记录异常事件到日志，建议用户调整增益参数
- **采样率过高导致浏览器卡顿**：自动降低实时显示的采样率（如从1000Hz降至100Hz），但仍以全采样率保存原始数据
- **长时间连续检测（超过1小时）**：系统应定期自动保存数据快照，防止数据丢失

#### 数据存储相关
- **云端存储空间不足**：提前预警，建议用户清理旧数据或升级存储容量
- **数据库连接失败**：显示友好的错误提示，允许用户选择重试或离线工作模式
- **并发写入冲突**：使用乐观锁机制，提示用户刷新后重试

#### 用户操作相关
- **用户长时间无操作（超过30分钟）**：自动保存当前状态，提示会话即将过期
- **误删除重要数据**：提供30天回收站机制，支持恢复已删除文件
- **浏览器不兼容**：检测浏览器版本，对于不支持的浏览器显示升级建议

#### 参数配置相关
- **参数组合不合理（如高电流+高增益导致饱和）**：智能检测并给出警告建议
- **加载已删除的配置预设**：显示"配置不存在"提示，自动切换到默认配置

---

## Requirements *(mandatory)*

### Functional Requirements

#### 界面与交互
- **FR-001**: 系统必须复现DOPPLER磁检测仪器的工业化外观，包括橙色外壳边框、黑色机身背景、金属质感和LED指示灯效果
- **FR-002**: 系统必须在左侧提供6个橙色功能按钮（播放/暂停、上传、显示模式、接地、门控、VPA），右侧提供3个控制按钮（回退、保存、菜单）
- **FR-003**: 所有按钮必须支持鼠标悬停高亮、点击下压效果和音效反馈
- **FR-004**: 系统必须支持键盘快捷键操作（F1-F6对应左侧按钮，Ctrl+S保存，Ctrl+M菜单等）
- **FR-005**: 界面必须适配1920x1080及以上分辨率，在不同屏幕尺寸下保持正确比例

#### 实时信号显示
- **FR-006**: 系统必须在主显示区域实时显示磁信号波形，刷新率不低于30fps
- **FR-007**: 系统必须同时显示双通道信号（通道1-横向磁化，通道2-纵向磁化），支持单通道/双通道切换
- **FR-008**: 波形图必须支持鼠标滚轮缩放、拖拽平移、点击标注功能
- **FR-009**: 系统必须在顶部数据表格区域实时显示关键参数（当前幅值、峰值、平均值、标准差等）
- **FR-010**: 当信号幅值超过设定阈值时，系统必须自动在波形上标记并记录时间戳和位置坐标

#### 实验数据管理
- **FR-011**: 系统必须允许用户创建新实验项目，包含必填字段：项目名称、工件名称、检测标准、操作人员姓名和资质
- **FR-012**: 系统必须支持设置磁化参数（磁化方式、电流0-2000mA、频率0-1000Hz、时间0.5-10秒）
- **FR-013**: 系统必须支持设置检测参数（磁粉类型、灵敏度等级、扫描速度、观察条件等）
- **FR-014**: 系统必须自动为每个实验分配唯一编号（格式：EXP-YYYYMMDD-序号）
- **FR-015**: 系统必须在用户修改实验数据后自动保存到云端，保存响应时间不超过2秒
- **FR-016**: 系统必须支持按项目名称、日期范围、工件名称、操作人员搜索实验记录
- **FR-017**: 系统必须允许用户加载历史实验，恢复所有参数配置和关联的波形数据

#### 缺陷记录
- **FR-018**: 系统必须允许用户手动创建缺陷记录，包含：缺陷类型（裂纹/气孔/夹杂/未熔合/未焊透等）、位置坐标、尺寸、严重程度（1-5级）
- **FR-019**: 系统必须支持在波形图上点击位置自动创建缺陷记录，自动填充位置和信号参数
- **FR-020**: 系统必须计算并显示缺陷统计数据：总数、各类型数量、缺陷密度（个/米）、合格率
- **FR-021**: 系统必须支持缺陷记录的查询、过滤（按类型、严重程度、位置）和导出

#### 参数配置
- **FR-022**: 系统必须提供参数配置界面，包含磁化参数、增益参数（0-100dB）、门控参数（位置0-100mm、宽度1-50mm、阈值0-100%）、滤波器参数（低通/高通/带通）
- **FR-023**: 系统必须对参数输入进行验证，拒绝超出有效范围的值并显示错误提示
- **FR-024**: 系统必须支持保存配置预设（用户命名），并可随时加载预设恢复参数
- **FR-025**: 系统必须将参数变更记录到实验日志，包含变更时间、变更人、变更前后值

#### 文件管理
- **FR-026**: 系统必须提供树形文件管理界面，支持创建、重命名、删除文件夹
- **FR-027**: 系统必须将文件按类型分类：实验数据、检测报告、波形图像、配置文件
- **FR-028**: 系统必须支持文件搜索（按名称、类型、日期）
- **FR-029**: 系统必须支持单个或批量文件下载，打包为ZIP格式

#### 报告生成
- **FR-030**: 系统必须支持生成PDF格式的检测报告，包含以下章节：封面、实验信息、检测参数、磁化曲线、波形图、缺陷列表、统计分析、结论、签名栏
- **FR-031**: 报告必须符合ISO 9934-1:2016标准模板要求
- **FR-032**: 系统必须支持自定义报告模板（上传Logo、修改页眉页脚、调整章节顺序）
- **FR-033**: 系统必须支持批量生成多个实验的报告

#### 数据导出
- **FR-034**: 系统必须支持导出原始信号数据为CSV格式，包含时间戳、通道、幅值、频率、相位等列
- **FR-035**: 系统必须支持导出缺陷记录为Excel格式，包含所有缺陷属性字段
- **FR-036**: 系统必须支持导出多个实验的汇总数据为Excel文件（多Sheet页）

#### 用户认证与权限
- **FR-037**: 系统必须支持用户注册（邮箱+密码）、登录、登出功能
- **FR-038**: 系统必须提供三种用户角色：管理员（全部权限）、操作员（可创建和修改实验）、查看者（只读权限）
- **FR-039**: 系统必须记录所有用户操作到系统日志，包含：操作类型、操作对象、时间戳、IP地址
- **FR-040**: 管理员必须能够查看和管理所有用户账户（修改角色、禁用账户）

#### 数据存储与同步
- **FR-041**: 系统必须将所有实验数据、信号数据、缺陷记录、用户数据存储到云端数据库（Supabase）
- **FR-042**: 系统必须支持实时数据同步，多个用户查看同一实验时，数据变更自动刷新
- **FR-043**: 系统必须在网络中断时启用离线工作模式，将数据暂存本地，网络恢复后自动同步
- **FR-044**: 系统必须每隔10秒自动批量上传信号数据到云端，避免频繁写入影响性能

#### 系统设置
- **FR-045**: 系统必须提供系统设置界面，包含：用户信息管理、设备校准记录、数据备份设置、语言选择（中文/英文）
- **FR-046**: 系统必须支持查看设备校准历史记录，包含校准日期、下次校准日期、校准结果
- **FR-047**: 系统必须提供数据导入功能，允许用户导入旧系统的实验数据（支持CSV/Excel格式）

---

### Key Entities

#### 实验项目 (Experiment)
- **代表含义**：一次完整的磁检测实验
- **核心属性**：项目名称、项目编号、工件信息（名称、材料、规格、批次号）、检测标准、操作人员信息、检测日期、磁化参数、检测参数、检测结果（合格/不合格）、备注
- **关系**：一个实验包含多条信号数据、多个缺陷记录、一个或多个报告文件

#### 磁信号数据 (Signal Data)
- **代表含义**：实时采集的磁信号波形数据点
- **核心属性**：时间戳、通道号（1/2）、位置坐标、幅值、频率、相位、是否异常标记
- **关系**：从属于某个实验项目

#### 缺陷记录 (Defect)
- **代表含义**：检测到的工件缺陷
- **核心属性**：缺陷编号、类型、位置坐标（X、Y、Z）、尺寸（长度、宽度、深度）、严重程度（1-5级）、信号特征、是否确认、确认人、描述
- **关系**：从属于某个实验项目

#### 参数配置 (Configuration)
- **代表含义**：一组检测参数的预设配置
- **核心属性**：配置名称、磁化电流、增益、门控位置、门控宽度、门控阈值、滤波器类型、是否默认配置、是否公开
- **关系**：由某个用户创建，可被多个实验引用

#### 用户 (User)
- **代表含义**：系统使用者
- **核心属性**：用户名、邮箱、全名、角色（管理员/操作员/查看者）、资质证书编号、部门、是否激活
- **关系**：创建和操作多个实验项目、拥有多个配置预设

#### 文件 (File)
- **代表含义**：与实验相关的文件（报告、图像、原始数据等）
- **核心属性**：文件名、文件类型、文件大小、存储路径、上传时间、是否公开
- **关系**：关联到某个实验项目

#### 系统日志 (System Log)
- **代表含义**：用户操作记录
- **核心属性**：操作类型、操作描述、用户ID、资源类型、资源ID、IP地址、时间戳、操作结果（成功/失败）
- **关系**：由某个用户触发

#### 设备校准记录 (Calibration Record)
- **代表含义**：设备校准历史
- **核心属性**：校准日期、下次校准日期、校准人、校准标准、校准结果、校准证书编号
- **关系**：独立实体，用于质量追溯

---

## Success Criteria *(mandatory)*

### Measurable Outcomes

#### 用户体验指标
- **SC-001**: 新用户在5分钟内能够独立完成第一次实验项目创建和信号监测
- **SC-002**: 95%的用户能够在第一次使用时正确找到所有主要功能（实验创建、信号监测、缺陷记录、报告生成）
- **SC-003**: 用户满意度评分（1-5分）平均达到4.5分以上
- **SC-004**: 用户从旧系统迁移到新系统的培训时间不超过2小时

#### 性能指标
- **SC-005**: 页面首次加载时间不超过3秒（在标准4G网络环境下）
- **SC-006**: 波形图实时刷新帧率达到30fps以上，视觉流畅无卡顿
- **SC-007**: 实验数据保存响应时间不超过2秒
- **SC-008**: 历史实验搜索响应时间不超过1秒（数据量1000条以内）
- **SC-009**: 系统支持至少100个并发用户同时访问而不出现性能降级

#### 功能完整性指标
- **SC-010**: 实现参考界面中所有可见的功能按钮和控制元素（左侧6个+右侧3个=9个主要按钮）
- **SC-011**: 支持ISO 9934-1:2016标准要求的所有检测参数记录（共计25+字段）
- **SC-012**: 缺陷类型覆盖常见的7种缺陷（裂纹、气孔、夹杂、未熔合、未焊透、咬边、错边）

#### 数据准确性指标
- **SC-013**: 信号数据采样精度达到0.01mV
- **SC-014**: 位置坐标测量精度达到0.1mm
- **SC-015**: 自动缺陷识别准确率达到90%以上（与人工标注对比）

#### 可靠性指标
- **SC-016**: 系统正常运行时间（Uptime）达到99.5%以上
- **SC-017**: 数据自动保存成功率达到99.9%以上
- **SC-018**: 网络中断后数据恢复成功率达到100%

#### 业务价值指标
- **SC-019**: 检测报告生成时间从人工30分钟缩短到自动1分钟以内
- **SC-020**: 实验数据查询效率提升10倍（从平均5分钟人工翻找到30秒内系统检索）
- **SC-021**: 减少因数据记录错误导致的返工率至少50%
- **SC-022**: 支持远程访问，使检测人员可以在任何地点查看实验数据，提升协作效率

---

## Assumptions *(optional)*

### 技术环境假设
1. **浏览器环境**：用户使用Chrome 90+、Edge 90+或Firefox 88+等现代浏览器，支持ES6+和HTML5 Canvas
2. **网络环境**：用户有稳定的互联网连接，带宽不低于4Mbps（下行）
3. **屏幕分辨率**：用户设备屏幕分辨率不低于1920x1080

### 业务流程假设
1. **操作人员资质**：使用系统的操作人员已获得NDT二级或以上资质证书，熟悉磁粉检测基本原理
2. **检测标准**：默认采用ISO 9934-1:2016标准，其他标准（ASTM E1444、GB/T 15822）可作为可选项
3. **数据存储**：Supabase提供足够的存储空间和数据库性能，单个实验数据量不超过100MB

### 数据假设
1. **信号采样率**：默认采样率为1000Hz，满足大多数检测场景，极端情况可调整至100-5000Hz
2. **实验时长**：单次实验检测时长通常不超过1小时，系统无需考虑超长时间连续运行
3. **缺陷密度**：工件缺陷密度通常在0-10个/米范围内，极端情况不超过50个/米

### 用户假设
1. **用户设备**：用户使用台式机或笔记本电脑，不考虑移动端（手机/平板）适配（可作为未来扩展）
2. **用户语言**：初期版本仅支持中文，英文版本作为二期需求
3. **用户数量**：初期部署用户数量在10-100人范围内

---

## Out of Scope *(optional)*

以下功能明确不包含在本次开发范围内，可作为未来扩展：

### 硬件集成
1. **直接控制硬件设备**：本系统为纯Web应用，不直接连接和控制物理磁检测设备，信号数据通过模拟生成或外部导入
2. **实时硬件数据采集**：不实现从传感器实时采集数据的驱动程序，此功能需要额外的硬件接口开发

### 高级分析功能
1. **机器学习缺陷识别**：自动缺陷识别使用基于阈值的简单算法，不包含深度学习模型训练和推理
2. **三维可视化**：缺陷位置以二维坐标显示，不提供三维模型渲染
3. **多传感器融合**：仅支持双通道磁信号，不支持与其他NDT方法（超声、射线）的数据融合

### 企业级功能
1. **工作流引擎**：不包含复杂的审批流程（如实验报告需要三级审批）
2. **ERP/MES集成**：不与企业资源规划或制造执行系统集成，数据独立管理
3. **移动端App**：不开发iOS/Android原生应用

### 高级权限管理
1. **细粒度权限控制**：仅提供三种基本角色，不支持自定义权限组合
2. **多租户架构**：不支持多个独立客户共享同一系统实例，每个客户需独立部署

---

## Dependencies & Constraints *(optional)*

### 外部依赖
1. **Supabase服务**：系统完全依赖Supabase提供的数据库、存储、认证服务，需确保Supabase可用性
2. **CDN服务**：第三方库（ECharts、Supabase Client SDK）通过CDN加载，需要稳定的CDN访问
3. **浏览器API**：依赖HTML5 Canvas、LocalStorage、IndexedDB等浏览器API

### 技术约束
1. **纯前端实现**：不编写任何后端代码，所有业务逻辑在浏览器端执行
2. **静态托管**：系统部署为静态网站（Netlify），不支持服务器端渲染
3. **数据库访问**：通过Supabase Client SDK直接访问数据库，受RLS（行级安全）策略限制

### 性能约束
1. **浏览器内存限制**：信号数据在内存中缓存不超过100MB，超出部分需从数据库重新加载
2. **波形渲染性能**：单屏波形数据点不超过10000个，更多数据通过分页或抽样显示

### 合规约束
1. **数据安全**：敏感数据（用户密码）必须加密存储，符合GDPR/CCPA数据保护要求
2. **标准符合性**：检测报告格式必须符合ISO 9934-1:2016标准模板

---

## Open Questions *(optional)*

以下问题需要在后续明确或由用户决策：

1. **信号数据来源**：由于是纯Web应用无法直接采集硬件信号，是使用模拟数据演示，还是支持导入外部采集的数据文件？
   - **建议方案A**：提供模拟信号生成器，自动生成符合真实特征的波形数据（包含随机缺陷），用于演示和培训
   - **建议方案B**：支持CSV/DAT文件导入，用户可以从外部设备采集数据后上传到系统
   - **建议方案C**：两者都支持，既可模拟也可导入真实数据

2. **多语言支持优先级**：初期版本是否需要支持英文？
   - **建议**：V1.0仅支持中文，V1.1添加英文支持（国际化框架预留）

3. **离线模式深度**：网络中断时，是否支持完整的离线工作（包括创建新实验、记录缺陷），还是仅允许查看已缓存的数据？
   - **建议**：V1.0支持数据查看和临时缓存，V1.1添加完整离线模式（使用Service Worker和IndexedDB）

---

**文档状态**：待评审  
**下一步行动**：评审本规格说明文档 → 创建技术设计文档（plan.md） → 生成任务列表（tasks.md） → 开始开发